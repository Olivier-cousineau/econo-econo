<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>EconoDeal ‚Äì Liquidations multi‚Äëmagasins</title>
  <style>
    :root{--bg:#0b1020;--card:#121933;--muted:#1a2240;--text:#e9ecff;--accent:#7aa2ff}
    *{box-sizing:border-box}
    body{margin:0;background:linear-gradient(180deg,#090e1d,#0d142b);color:var(--text);font-family:system-ui,-apple-system,Segoe UI,Roboto,"Helvetica Neue",Arial}
    header{position:sticky;top:0;background:#0c1227cc;backdrop-filter:blur(6px);border-bottom:1px solid #1d2546}
    .container{max-width:1200px;margin:0 auto;padding:14px 16px}
    .bar{display:flex;align-items:center;gap:16px;flex-wrap:wrap}
    .brand{display:flex;align-items:center;gap:10px;margin-right:auto}
    .brand img{width:32px;height:32px;border-radius:6px}
    .brand .logo{font-weight:800;letter-spacing:.3px;font-size:clamp(18px,3vw,22px)}

    .toolbar{display:flex;gap:10px;flex-wrap:wrap}
    .dd{display:flex;align-items:center;gap:8px;background:var(--muted);border:1px solid #2a3566;border-radius:999px;padding:6px 10px}
    .dd select,.dd input[type="search"]{appearance:none;background:transparent;border:none;color:var(--text);outline:none}
    .dd select{padding-right:18px}
    .dd .label{opacity:.9}

    .grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(260px,1fr));gap:14px;padding:16px}
    .card{background:var(--card);border:1px solid #1f2953;border-radius:16px;overflow:hidden;display:flex;flex-direction:column;min-height:290px}
    .thumb{aspect-ratio:16/10;background:#0e1430 center/cover;display:flex;align-items:center;justify-content:center;color:#6278ff;font-size:14px}
    .body{padding:12px 14px;display:flex;flex-direction:column;gap:8px}
    .title{font-weight:600;line-height:1.2}
    .meta{display:flex;gap:8px;flex-wrap:wrap;font-size:12px;color:#b8c0ff}
    .tag{background:#0f1733;border:1px solid #2b3a88;border-radius:999px;padding:2px 8px}
    .price{display:flex;align-items:baseline;gap:8px}
    .old{opacity:.6;text-decoration:line-through}
    .btn{display:inline-flex;align-items:center;gap:8px;background:linear-gradient(180deg,#2a49ff,#2038d9);border:1px solid #6278ff;color:white;padding:8px 10px;border-radius:10px;text-decoration:none;font-weight:600}

    .slider{display:flex;align-items:center;gap:10px}
    .slider input[type=range]{width:140px}

    footer{color:#97a0da70;border-top:1px solid #1d2546}
    .empty{opacity:.7;padding:32px;text-align:center}
  </style>
</head>
<body>
  <header>
    <div class="container bar">
      <div class="brand">
        <img src="logo.png" alt="Logo EconoDeal" />
        <span class="logo">EconoDeal</span>
      </div>

      <div class="toolbar">
        <label class="dd">
          <span class="label">üîé</span>
          <input id="q" type="search" placeholder="Rechercher‚Ä¶" aria-label="Recherche" />
        </label>

        <label class="dd">
          <span class="label" data-i18n="store">Magasin</span>
          <select id="store" aria-label="Magasin" onchange="applyFilters()">
            <option value="">Tous</option>
            <option value="Walmart">Walmart</option>
            <option value="Home Depot">Home Depot</option>
            <option value="Canadian Tire">Canadian Tire</option>
            <option value="Rona">Rona</option>
            <option value="Patrick Morin">Patrick Morin</option>
            <option value="Sporting Life">Sporting Life</option>
          </select>
        </label>

        <label class="dd">
          <span class="label" data-i18n="city">Ville</span>
          <select id="city" aria-label="Ville" onchange="applyFilters()">
            <option value="">Toutes</option>
            <option value="Montreal">Montreal</option>
            <option value="Laval">Laval</option>
            <option value="St Jerome">St Jerome</option>
            <option value="Saint-J√©r√¥me">Saint-J√©r√¥me</option>
            <option value="Blainville">Blainville</option>
          </select>
        </label>

        <label class="dd slider">
          <span class="label" data-i18n="minDiscount">Rabais ‚â• %</span>
          <input id="minOffRange" type="range" min="0" max="90" step="5" value="0" />
          <input id="minOff" type="number" min="0" max="95" step="1" value="0" style="width:70px"/>
        </label>

        <label class="dd">
          <span class="label" data-i18n="sort">Tri</span>
          <select id="sort" onchange="applyFilters()">
            <option value="discount_desc">% rabais ‚Üì</option>
            <option value="price_asc">Prix ‚Üë</option>
            <option value="price_desc">Prix ‚Üì</option>
            <option value="newest">Nouveaux</option>
          </select>
        </label>

        <label class="dd" style="gap:6px">
          <span>üåê</span>
          <select id="lang" aria-label="Langue">
            <option value="fr">FR</option>
            <option value="en">EN</option>
          </select>
        </label>
      </div>
    </div>
  </header>

  <main class="container">
    <div id="filtersStatus" style="margin:6px 0 0 0;color:#9fb1ff;font-size:14px"></div>
    <div id="count" style="margin-top:10px;color:#9fb1ff"></div>
    <section id="grid" class="grid" aria-live="polite"></section>
    <div id="empty" class="empty" hidden>üòï Aucun r√©sultat. Ajuste les filtres.</div>
  </main>

  <footer class="container" style="padding:20px 16px 40px">
    <small>¬© <span id="year"></span> EconoDeal ‚Ä¢ <span data-i18n="updated">Mise √† jour quotidienne √† 15h (heure du Qu√©bec)</span></small>
  </footer>

<script>
const I18N = {
  fr: {title:"Liquidations multi‚Äëmagasins", store:"Magasin", city:"Ville", minDiscount:"Rabais ‚â• %", sort:"Tri", updated:"Mise √† jour quotidienne √† 15h (Qu√©bec)", buy:"Voir l'offre", off:"de rabais", newest:"Nouveaux"},
  en: {title:"Multi‚Äëstore clearances", store:"Store", city:"City", minDiscount:"Discount ‚â• %", sort:"Sort", updated:"Updated daily at 3pm (Quebec)", buy:"View deal", off:"off", newest:"Newest"}
};
let LANG = 'fr';
// Afficher des donn√©es d'exemple ? Mettez true pour l'aper√ßu, false pour vide
const USE_DEMO = false;
function applyI18n(){ document.querySelectorAll('[data-i18n]').forEach(el=>{el.textContent = I18N[LANG][el.dataset.i18n]}); }

// --- Donn√©es de d√©mo (aper√ßu) ---
const DEMO = [
  {title:"T√©l√©vision 55''", price:499, was:799, pct:38, store:"Walmart", city:"Laval", url:"#", image:""},
  {title:"BBQ au gaz", price:299, was:599, pct:50, store:"Home Depot", city:"Montr√©al", url:"#", image:""},
  {title:"Perceuse DeWalt", price:129, was:199, pct:35, store:"Rona", city:"Saint-J√©r√¥me", url:"#", image:""},
  {title:"Chaise de bureau", price:199, was:299, pct:33, store:"Sorting Life", city:"Montr√©al", url:"#", image:""}
];
let ALL = (typeof USE_DEMO !== 'undefined' && USE_DEMO) ? DEMO : [];

function fmtPrice(v){ return (v==null||v==='')? '‚Äî' : new Intl.NumberFormat(LANG==='fr'?'fr-CA':'en-CA',{style:'currency',currency:'CAD'}).format(+v) }

function render(list){
  const grid = document.getElementById('grid');
  grid.innerHTML = '';
  document.getElementById('count').textContent = `${list.length} items`;
  const emptyEl = document.getElementById('empty');
  if(!list.length){
    emptyEl.innerText = (ALL.length===0)
      ? 'üìÑ Aucune donn√©e charg√©e. Les menus fonctionnent, mais la liste est vide. Ajoute des fichiers ou active USE_DEMO pour tester.'
      : 'üòï Aucun r√©sultat. Ajuste les filtres.';
    emptyEl.hidden=false; return;
  } else emptyEl.hidden=true;
  for(const it of list){
    const card = document.createElement('article'); card.className='card';
    card.innerHTML = `
      <a class="thumb" href="${it.url}" target="_blank" rel="noopener">${it.image?`<img src="${it.image}" alt="">`:"Aper√ßu"}</a>
      <div class="body">
        <div class="title">${it.title}</div>
        <div class="meta">
          <span class="tag">${it.store}</span>
          ${it.city?`<span class="tag">${it.city}</span>`:''}
          ${Number.isFinite(it.pct)?`<span class="tag">-${it.pct}%</span>`:''}
        </div>
        <div class="price">
          <strong>${fmtPrice(it.price)}</strong>
          ${it.was?`<span class="old">${fmtPrice(it.was)}</span>`:''}
        </div>
        <div style="margin-top:auto">
          <a class="btn" href="${it.url}" target="_blank" rel="noopener">üîó ${I18N[LANG].buy}</a>
        </div>
      </div>`;
    grid.appendChild(card);
  }
}

function applyFilters(){
  const q = document.getElementById('q').value.trim().toLowerCase();
  const store = document.getElementById('store').value;
  const city = document.getElementById('city').value;
  const minOff = +document.getElementById('minOff').value || 0;
  const sort = document.getElementById('sort').value;

  // Afficher l'√©tat courant des filtres pour donner un retour visuel
  document.getElementById('filtersStatus').textContent = `Filtre actif ‚Üí Magasin: ${store||'Tous'} ‚Ä¢ Ville: ${city||'Toutes'} ‚Ä¢ Rabais ‚â• ${minOff}%`;

  let list = ALL.filter(it=>{
    if(q && !(`${it.title}`.toLowerCase()).includes(q)) return false;
    if(store && it.store!==store) return false;
    if(city && it.city!==city) return false;
    if(Number.isFinite(minOff) && (it.pct ?? -999) < minOff) return false;
    return true;
  });
  const by = {
    discount_desc:(a,b)=>(b.pct||-1)-(a.pct||-1),
    price_asc:(a,b)=>(a.price??1e15)-(b.price??1e15),
    price_desc:(a,b) => (b.price??-1)-(a.price??-1),
    newest:(a,b)=>0
  }[sort];
  list.sort(by);
  render(list);
}

function attach(){
  // champs texte / nombre : on √©coute 'input'
  ['q','minOff'].forEach(id=> document.getElementById(id).addEventListener('input', applyFilters));
  document.getElementById('minOffRange').addEventListener('input', (e)=>{
    document.getElementById('minOff').value = e.target.value;
    applyFilters();
  });
  document.getElementById('minOff').addEventListener('input', (e)=>{
    document.getElementById('minOffRange').value = e.target.value;
  });

  // menus d√©roulants : utiliser 'change' (plus fiable que 'input' sur <select>)
  ['store','city','sort'].forEach(id=> document.getElementById(id).addEventListener('change', applyFilters));
  document.getElementById('lang').addEventListener('change', (e)=>{ LANG=e.target.value; applyI18n(); render(ALL); });
}

(function init(){
  document.getElementById('year').textContent = new Date().getFullYear();
  applyI18n();
  attach();
  render(ALL);
})();
</script>
</body>
</html>
